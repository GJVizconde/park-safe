import{_ as v,B as x}from"./ButtonForm-BMwQE9_a.js";import{_ as S}from"./ParkSafeLayout.vue_vue_type_script_setup_true_lang-Bv4m9liE.js";import{_ as g}from"./SelectForm.vue_vue_type_script_setup_true_lang-DeS5sWG2.js";import{a as k}from"./axios-Cm0UX6qg.js";import{d as E,r as t,i as B,b as h,w as b,c as C,e as s,a as f,F as T,o as w}from"./index-DC_smAf1.js";const P={class:"px-5"},D={class:"flex justify-center items-center mt-[50px]"},L=E({__name:"GenerateTicket",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(V){const i=t("https://park-safe-api.onrender.com/api"),r=t({name:"",id:"",email:"",role:"",hasTicket:"",token:""}),o=t({userId:"",vehicleId:"",parkingPlace:"",collaboratorId:""}),n=t([{id:0,name:"",email:"",password:"",role:"USER",vehicles:[]}]),c=B(V,"modelValue"),d=t(),y=t(),u=t(!0),_=()=>{console.log("Me hicierÃ³n click"),U(o.value)},I=async()=>{try{const e=(await k.get(`${i.value}/user`)).data;console.log(e),n.value=e,console.log("users => ",n.value)}catch(e){console.error("Error al obtener el ticket:",e)}},U=async e=>{try{const a=(await k.post(`${i.value}/ticket/`,e)).data;console.log(a),y.value=a}catch(a){console.error("Error al generar el ticket: ",a)}},m=()=>{console.log("Se hizo un cambioo")};return h(async()=>{await I()}),h(()=>{const e=localStorage.getItem("userSession");r.value=e?JSON.parse(e):{name:"",id:"",email:"",role:"",hasTicket:!1,token:""}}),b(o.value,e=>{console.log("FormData has changed",e)},{deep:!0}),b(c,e=>{var a;console.log("NUEVO valor de model ==>>",e),console.log("NUEVO valor de value.vehicles ==>>",e.vehicles),o.value.userId=e.id,d.value=e.vehicles,o.value.collaboratorId=r.value.id,u.value=!((a=e==null?void 0:e.vehicles[0])!=null&&a.id)},{deep:!0}),(e,a)=>{var p;return w(),C(T,null,[s(S,{title:"Generar Ticket"}),f("section",P,[s(g,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=l=>c.value=l),onChange:m,label:"Usuario","data-options":n.value,typeData:"user"},null,8,["modelValue","data-options"]),s(g,{modelValue:o.value.vehicleId,"onUpdate:modelValue":a[1]||(a[1]=l=>o.value.vehicleId=l),onChange:m,label:"Placa","data-options":d.value,typeData:"vehicle",disabled:u.value},null,8,["modelValue","data-options","disabled"]),s(v,{modelValue:o.value.parkingPlace,"onUpdate:modelValue":a[2]||(a[2]=l=>o.value.parkingPlace=l),id:"Place",name:"Place",label:"Lugar",placeholder:"Ingresar Lugar",type:"text"},null,8,["modelValue"]),s(v,{modelValue:o.value.collaboratorId,"onUpdate:modelValue":a[3]||(a[3]=l=>o.value.collaboratorId=l),id:"collaborator",name:"collaborator",label:"Empleado",placeholder:"Colaborador",value:(p=r.value)==null?void 0:p.name,type:"text",disabled:"",class:"text-gray-500"},null,8,["modelValue","value"])]),f("div",D,[s(x,{label:"Generar ticket",buttonType:"inputForm",size:"standard-form",onClick:_})])],64)}}});export{L as default};
