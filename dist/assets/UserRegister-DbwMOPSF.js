import{_ as B,B as P}from"./ButtonForm-Dv8t65T4.js";import{_ as A,a as c}from"./axios-CqazS-pc.js";import{d as U,r as t,w as p,b as m,c as w,e as g,a as f,F as h,f as F,u as M,g as O,o as i,h as V}from"./index-B832EyZB.js";import{i as v}from"./index-4PIaK5gb.js";const E={id:{label:"Cédula",placeholder:"Número de cédula",type:"number"},name:{label:"Nombre",placeholder:"Ingresar nombre",type:"text"},email:{label:"Email",placeholder:"Ingresar correo eléctronico",type:"email"},password:{label:"Password",placeholder:"Ingresar Password",type:"password",eyeIcon:"true"},passwordConfirm:{label:"Confirmar Password",placeholder:"Confirmar Password",type:"password",eyeIcon:"true"}},L={class:"px-5"},$={class:"flex justify-center items-center mt-[50px]"},G=U({__name:"UserRegister",setup(H){const r=t("https://park-safe-api.onrender.com/api"),a=t({email:"",id:"",label:"",name:"",password:"",passwordConfirm:""}),s=t({name:"",id:"",email:"",role:"",hasTicket:!1,token:""});let d=t("password"),u=t("password");const b=(e,o)=>{o==="Password"?d.value=e:u.value=e},y=(e,o)=>e==="Password"?d.value:e==="Confirmar Password"?u.value:o,C=O(),_=()=>{C.push({path:"/"})},k=()=>{v.success("Inicio de Sesion, exitoso !",{theme:"colored",autoClose:2e3,onClose:_,position:"bottom-center"})},I=()=>{v.success("Registro de empleado, exitoso !",{theme:"colored",autoClose:2e3,position:"bottom-center"})},N=async()=>{const e=(await c.post(`${r.value}/auth/login`,{id:a.value.id,password:a.value.password})).data;console.log(e);const o=e.user,l=e.token;console.log(o),s.value={id:o.id,name:o.name,email:o.email,role:o.role,hasTicket:o.hasTicket,token:l},k()},S=async()=>{console.log("Hola",r.value),console.log("Me hicierón click");try{const e=(await c.post(`${r.value}/auth/register`,a.value)).data;console.log("UserData =>>",e),await N()}catch(e){console.log("Error registrando al nuevo usuario:",e)}},T=async()=>{console.log("Hola",r.value),console.log("Me hicierón click, soy ADMIN");try{const e=(await c.post(`${r.value}/collaborator/register`,{email:a.value.email,id:a.value.id,name:a.value.name,password:a.value.password,role:"COLLABORATOR"})).data;console.log(e)}catch(e){console.log("Error registrando un nuevo empleado: ",e)}},D=()=>{console.log(s.value.role==="ADMIN"),s.value.role==="ADMIN"?(T(),I()):S()};return p(a.value,e=>{console.log(e)},{deep:!0}),p(s,e=>{window.localStorage.setItem("userSession",JSON.stringify(e)),console.log(s.value)},{deep:!0}),m(()=>{const e=localStorage.getItem("userSession");s.value=e?JSON.parse(e):{name:"",id:"",email:"",role:"",hasTicket:!1,token:""},console.log(s.value.role)}),m(()=>{}),(e,o)=>(i(),w(h,null,[g(A,{title:"Registro"}),f("section",L,[(i(!0),w(h,null,F(M(E),(l,n)=>(i(),V(B,{modelValue:a.value[n],"onUpdate:modelValue":x=>a.value[n]=x,key:n,id:l.label,name:l.label,label:l.label,placeholder:l.placeholder,type:y(l.label,l.type),labelFor:l.label,icon:!!l.label.toUpperCase().includes("PASSWORD"),onChangeType:b},null,8,["modelValue","onUpdate:modelValue","id","name","label","placeholder","type","labelFor","icon"]))),128))]),f("div",$,[g(P,{label:"Registrar",buttonType:"inputForm",size:"standard-form",onClick:D})])],64))}});export{G as default};
