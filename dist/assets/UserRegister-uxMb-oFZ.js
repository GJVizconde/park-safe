import{_ as T,B}from"./ButtonForm-fsE9RK2k.js";import{_ as P,a as c}from"./axios-iTDiG_qe.js";import{d as x,r as t,w as p,b as m,c as w,e as g,a as f,F as h,f as A,u as U,g as F,o as i,h as M}from"./index-Clvp6r8e.js";import{i as O}from"./index-BacjHjJ9.js";const V={id:{label:"Cédula",placeholder:"Número de cédula",type:"number"},name:{label:"Nombre",placeholder:"Ingresar nombre",type:"text"},email:{label:"Email",placeholder:"Ingresar correo eléctronico",type:"email"},password:{label:"Password",placeholder:"Ingresar Password",type:"password",eyeIcon:"true"},passwordConfirm:{label:"Confirmar Password",placeholder:"Confirmar Password",type:"password",eyeIcon:"true"}},E={class:"px-5"},L={class:"flex justify-center items-center mt-[50px]"},z=x({__name:"UserRegister",setup($){const r=t("https://park-safe-api.onrender.com/api"),a=t({email:"",id:"",label:"",name:"",password:"",passwordConfirm:""}),s=t({name:"",id:"",email:"",role:"",hasTicket:!1,token:""});let d=t("password"),u=t("password");const v=(e,o)=>{o==="Password"?d.value=e:u.value=e},b=(e,o)=>e==="Password"?d.value:e==="Confirmar Password"?u.value:o,y=F(),_=()=>{y.push({path:"/"})},C=()=>{O.success("Inicio de Sesion, exitoso !",{theme:"colored",autoClose:2e3,onClose:_,position:"bottom-center"})},k=async()=>{const e=(await c.post(`${r.value}/auth/login`,{id:a.value.id,password:a.value.password})).data;console.log(e);const o=e.user,l=e.token;console.log(o),s.value={id:o.id,name:o.name,email:o.email,role:o.role,hasTicket:o.hasTicket,token:l},C()},I=async()=>{console.log("Hola",r.value),console.log("Me hicierón click");try{const e=(await c.post(`${r.value}/auth/register`,a.value)).data;console.log("UserData =>>",e),await k()}catch(e){console.log("Error registrando al nuevo usuario:",e)}},N=async()=>{console.log("Hola",r.value),console.log("Me hicierón click, soy ADMIN");try{const e=(await c.post(`${r.value}/collaborator/register`,{email:a.value.email,id:a.value.id,name:a.value.name,password:a.value.password,role:"COLLABORATOR"})).data;console.log(e)}catch(e){console.log("Error registrando un nuevo empleado: ",e)}},S=()=>{console.log(s.value.role==="ADMIN"),s.value.role==="ADMIN"?N():I()};return p(a.value,e=>{console.log(e)},{deep:!0}),p(s,e=>{window.localStorage.setItem("userSession",JSON.stringify(e)),console.log(s.value)},{deep:!0}),m(()=>{const e=localStorage.getItem("userSession");s.value=e?JSON.parse(e):{name:"",id:"",email:"",role:"",hasTicket:!1,token:""},console.log(s.value.role)}),m(()=>{}),(e,o)=>(i(),w(h,null,[g(P,{title:"Registro"}),f("section",E,[(i(!0),w(h,null,A(U(V),(l,n)=>(i(),M(T,{modelValue:a.value[n],"onUpdate:modelValue":D=>a.value[n]=D,key:n,id:l.label,name:l.label,label:l.label,placeholder:l.placeholder,type:b(l.label,l.type),labelFor:l.label,icon:!!l.label.toUpperCase().includes("PASSWORD"),onChangeType:v},null,8,["modelValue","onUpdate:modelValue","id","name","label","placeholder","type","labelFor","icon"]))),128))]),f("div",L,[g(B,{label:"Registrar",buttonType:"inputForm",size:"standard-form",onClick:S})])],64))}});export{z as default};
