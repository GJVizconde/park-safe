import{_ as B,B as P}from"./ButtonForm-DNhXx65Y.js";import{_ as A,a as c}from"./axios-D99c7W0C.js";import{d as U,r as t,w as p,b as m,c as w,e as v,a as g,F as f,f as F,u as M,g as O,o as i,h as V}from"./index-CXULmX_w.js";import{i as h}from"./index-CT4JV_wo.js";const E={id:{label:"Cédula",placeholder:"Número de cédula",type:"number"},name:{label:"Nombre",placeholder:"Ingresar nombre",type:"text"},email:{label:"Email",placeholder:"Ingresar correo eléctronico",type:"email"},password:{label:"Password",placeholder:"Ingresar Password",type:"password",eyeIcon:"true"},passwordConfirm:{label:"Confirmar Password",placeholder:"Confirmar Password",type:"password",eyeIcon:"true"}},L={class:"px-5"},$={class:"flex justify-center items-center mt-[50px]"},G=U({__name:"UserRegister",setup(H){const r=t("https://park-safe-api.onrender.com/api"),o=t({email:"",id:"",label:"",name:"",password:"",passwordConfirm:""}),s=t({name:"",id:"",email:"",role:"",hasTicket:!1,token:""});let d=t("password"),u=t("password");const b=(e,a)=>{a==="Password"?d.value=e:u.value=e},y=(e,a)=>e==="Password"?d.value:e==="Confirmar Password"?u.value:a,C=O(),_=()=>{C.push({path:"/"})},k=()=>{h.success("Inicio de Sesion, exitoso !",{theme:"colored",autoClose:2e3,onClose:_,position:"bottom-center"})},I=()=>{h.success("Registro de empleado, exitoso !",{theme:"colored",autoClose:2e3,position:"bottom-center"})},N=async()=>{const e=(await c.post(`${r.value}/auth/login`,{id:o.value.id,password:o.value.password})).data;console.log(e);const a=e.user,l=e.token;console.log(a),s.value={id:a.id,name:a.name,email:a.email,role:a.role,hasTicket:a.hasTicket,token:l},k()},S=async()=>{console.log("Hola",r.value),console.log("Me hicierón click");try{const e=(await c.post(`${r.value}/auth/register`,o.value)).data;console.log("UserData =>>",e),await N()}catch(e){console.log("Error registrando al nuevo usuario:",e)}},T=async()=>{console.log("Hola",r.value),console.log("Me hicierón click, soy ADMIN");try{const e=(await c.post(`${r.value}/collaborator/register`,{email:o.value.email,id:o.value.id,name:o.value.name,password:o.value.password,role:"COLLABORATOR"})).data;console.log(e)}catch(e){console.log("Error registrando un nuevo empleado: ",e)}},D=()=>{console.log(s.value.role==="ADMIN"),s.value.role==="ADMIN"?(T(),I(),o.value.email="",o.value.id="",o.value.name="",o.value.password="",o.value.passwordConfirm=""):S()};return p(o.value,e=>{console.log(e)},{deep:!0}),p(s,e=>{window.localStorage.setItem("userSession",JSON.stringify(e)),console.log(s.value)},{deep:!0}),m(()=>{const e=localStorage.getItem("userSession");s.value=e?JSON.parse(e):{name:"",id:"",email:"",role:"",hasTicket:!1,token:""},console.log(s.value.role)}),m(()=>{}),(e,a)=>(i(),w(f,null,[v(A,{title:"Registro"}),g("section",L,[(i(!0),w(f,null,F(M(E),(l,n)=>(i(),V(B,{modelValue:o.value[n],"onUpdate:modelValue":x=>o.value[n]=x,key:n,id:l.label,name:l.label,label:l.label,placeholder:l.placeholder,type:y(l.label,l.type),labelFor:l.label,icon:!!l.label.toUpperCase().includes("PASSWORD"),onChangeType:b},null,8,["modelValue","onUpdate:modelValue","id","name","label","placeholder","type","labelFor","icon"]))),128))]),g("div",$,[v(P,{label:"Registrar",buttonType:"inputForm",size:"standard-form",onClick:D})])],64))}});export{G as default};
